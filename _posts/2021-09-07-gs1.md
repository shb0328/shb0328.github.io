---
layout: "single"
title: "Google Apps Script - êµ¬ê¸€ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì—ì„œ ë§¤í¬ë¡œë§Œë“¤ê¸°"
categories: [unknown]
tags: [gs, Google Apps Script, vba, macro, spreadsheet]
permalink : /gs/1
---

ë™ìƒê³¼ ì˜ì–´ê³µë¶€ë¥¼ ìœ„í•´ ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ë¥¼ í™œìš©í•˜ì—¬ ë‹¨ì–´ì‹œí—˜ì§€ë¥¼ ë§Œë“œëŠ” ê³¼ì •ì„ ì¼ë¶€ ìë™í™”ì‹œì¼°ë‹¤. 
ì´ ê³¼ì •ì—ì„œ êµ¬ê¸€ ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ì—ì„œ í™œìš©ê°€ëŠ¥í•œ Google Apps Scriptì— ëŒ€í•´ ì•Œê²Œëœ ë‚´ìš©ì„ ì •ë¦¬í•´ë³´ê³ ì í•œë‹¤.

## ê³„ê¸°

ì˜ì–´ê³µë¶€ë¥¼ í•´ì•¼ê² ë‹¤ê³  ë§ˆìŒë¨¹ì—ˆëŠ”ë°, ì´ì™• í•˜ëŠ”ê±° ê³µì¸ ì‹œí—˜ì—ì„œ ì ìˆ˜ë¥¼ ë°›ì•„ë³´ê³  ì‹¶ì—ˆë‹¤. ëŒ€í•™êµ ì¡¸ì—…ì¡°ê±´ì„ ì±„ìš°ê¸° ìœ„í•´ í† ìŠ¤ë¥¼ ë³¸ ì ì€ ìˆì§€ë§Œ, ë§ì€ ì‚¬ëŒë“¤ì´ ì‘ì‹œí•˜ëŠ” í† ìµì„ í•œ ë²ˆë„ ì¹˜ë¤„ë³¸ ì ì´ ì—†ì–´ì„œ ì´ë²ˆ ê¸°íšŒì— ë„ì „í•´ë³´ê¸°ë¡œ í–ˆë‹¤.

ë™ìƒì´ë‘ ê°™ì´ êµ¬ê¸€ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì—ì„œ ë‹¨ì–´ ì‹œí—˜ì§€ë¥¼ ë§Œë“¤ì–´ì„œ ë§¤ì¼ ì‹œí—˜ì„ ë³´ê¸°ë¡œ í–ˆë‹¤. ë™ìƒì´ ì˜ˆì˜ê²Œ(?) formì„ ë§Œë“¤ì—ˆê³ , í•´ì»¤ìŠ¤ì—ì„œ ì œê³µí•˜ëŠ” ë‹¨ì–´ì¥ì— ìˆëŠ” ë‹¨ì–´ë¡œ ë²ˆê°ˆì•„ê°€ë©° ì‹œí—˜ì§€ë¥¼ ë§Œë“¤ê³  ì±„ì í•´ì£¼ê¸°ë¡œ í–ˆë‹¤.

![210907193823.png](/assets/images/210907193823.png)

ì—‘ì…€ì€ ê·¸ì € csv íŒŒì¼ì´ë¼ê³ ë§Œ ìƒê°í–ˆëŠ”ë°, ì‹œí—˜ì§€ë¥¼ ë§Œë“¤ë©´ì„œ ì²´í¬ë°•ìŠ¤ ê°™ì€ ê²ƒë„ ì…€ì— ë„£ì„ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œì•˜ë‹¤. ì²´í¬ë°•ìŠ¤ì˜ ê°’ìœ¼ë¡œëŠ” true/falseê°€ ë“¤ì–´ê°ˆ ìˆ˜ ìˆì–´ì„œ ì—‘ì…€ì˜ `COUNTIF`ì§‘ê³„í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ì²´í¬ë°•ìŠ¤ì˜ true ê°œìˆ˜ë¥¼ ì§‘ê³„í•´ì„œ ìë™ìœ¼ë¡œ ì±„ì ë˜ë„ë¡ í–ˆë‹¤.

```sql
=COUNTIF(A3:I19, TRUE)&" / 50"
```

ëª‡ ì¼ ë™ì•ˆ ì‹œí—˜ì§€ë¥¼ ë§Œë“¤ë©´ì„œ ëŠë‚€ ì ì€, ì‹œí—˜ì§€ ë‚´ìš©ì„ ì‘ì„±í•˜ëŠ” ê±´ ë§Œë“¤ë©´ì„œ ë‹¨ì–´ë„ ì™¸ìš°ê³  ê´œì°®ì€ë°, ì € í¬ë§·ì„ ìœ ì§€ì‹œí‚¤ëŠ” ê²ƒì´ ë„ˆë¬´ ê·€ì°®ì•˜ë‹¤. ê·¸ë¦¬ê³  ì—‘ì…€ì—ëŠ” ìƒê°ë³´ë‹¤ ë‹¤ì–‘í•œ ê¸°ëŠ¥ì´ ë§ì•˜ë‹¤. 'ë§¤í¬ë¡œ' ê¸°ëŠ¥ì„ ë°œê²¬í–ˆê³  ì•„ë˜ì™€ ê°™ì€ ë°˜ë³µì‘ì—…ì„ ìë™í™”í•´ë³´ê¸°ë¡œ í–ˆë‹¤.

## ìë™í™”í•  ì‘ì—… ëª©ë¡

```
1. ì‹œíŠ¸ë¥¼ ë³µì‚¬í•˜ê³  ì‹œíŠ¸ì´ë¦„ì„ DAY0 í˜•íƒœë¡œ ìˆ˜ì •
2. A1 ì…€ì— '0ì¼ì°¨', ë‚ ì§œë¥¼ ê¸°ì…
3. ì²´í¬ë°•ìŠ¤ë¥¼ ëª¨ë‘ í•´ì œ
4. ì „ë‚  ê¸°ì…í•œ ë‹¨ì–´ë¥¼ ì‚­ì œ
5. ë¹¨ê°„ìƒ‰ìœ¼ë¡œ ì˜¤ë‹µí‘œì‹œí•œ ì…€ì„ ë‹¤ì‹œ ê²€ì€ìƒ‰ìœ¼ë¡œ ë³€ê²½
```

## ë§¤í¬ë¡œ ë§Œë“¤ê¸°

`ë„êµ¬ > ë§¤í¬ë¡œ > ë§¤í¬ë¡œê¸°ë¡` ë¥¼ ì‹¤í–‰í•˜ê³  ì‹œíŠ¸ë³µì‚¬, ì´ë¦„ìˆ˜ì •, '0ì¼ì°¨' ê°’ì„ ê¸°ì…í•˜ëŠ” ë™ì‘ì„ í•˜ê³  ì €ì¥í–ˆë‹¤. 

í•˜ì§€ë§Œ ì´ ë°©ë²•ìœ¼ë¡œëŠ” ë§¤ë²ˆ ë™ì ìœ¼ë¡œ ë°”ë€Œì–´ì•¼í•˜ëŠ” ê°’ë“¤ì„ ì²˜ë¦¬í•  ìˆ˜ ì—†ì—ˆë‹¤. ì˜ˆë¥¼ë“¤ì–´ ë§¤í¬ë¡œë¥¼ ê¸°ë¡í•  ë•Œ ì…€ì— ë°ì´í„°ë¥¼ 'DAY11' ì´ë¼ê³  ì…ë ¥í–ˆìœ¼ë©´ ë§¤í¬ë¡œ ì‹¤í–‰ ì‹œ ë§¤ë²ˆ 'DAY11' ì´ë¼ê³  ê¸°ì…ë˜ëŠ” ê²ƒì´ë‹¤. ì´ê²ƒì€ ë‚´ê°€ ì›í•˜ë˜ ìë™í™”ê°€ ì•„ë‹ˆì—ˆë‹¤...

ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ êµ¬ê¸€ì— ì°¾ì•„ë³´ë‹ˆ ë°©ê¸ˆ ê¸°ë¡í•œ ë§¤í¬ë¡œë¥¼ ìŠ¤í¬ë¦½íŠ¸ë¡œì„œ í™•ì¸í•˜ê³  ë³€ê²½í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œì•˜ë‹¤ !!!

## Google Apps Script ì‘ì„±

ë°©ê¸ˆ ë§¤í¬ë¡œê¸°ë¡ì„ í†µí•´ ì €ì¥í•œ ë§¤í¬ë¡œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ìŠ¤í¬ë¦½íŠ¸ë¡œ ì €ì¥ë˜ì–´ìˆì—ˆë‹¤.

![210907143628.png](/assets/images/210907143628.png)

```js
/** @OnlyCurrentDoc */

function myFunction() {
  var spreadsheet = SpreadsheetApp.getActive();
  spreadsheet.getRange('C3').activate();
  spreadsheet.duplicateActiveSheet();
  spreadsheet.getActiveSheet().setName('DAY11');
  spreadsheet.getCurrentCell().setValue('DAY11');
  spreadsheet.getRange('A2').activate();
};
```

í˜„ì¬ í™œì„±í™”ëœ ì‹œíŠ¸ë¥¼ `getActive()` í•¨ìˆ˜ë¥¼ í†µí•´ `SpreadcheetApp` ê°ì²´ë¡œ ë°›ì•„ì™€ì„œ ë‹¤ì–‘í•œ í•¨ìˆ˜ë“¤ì„ ì‚¬ìš©í•˜ëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤. ë§¤í¬ë¡œ ê¸°ë¡ ë‹¹ì‹œ C3 ì…€ì„ í´ë¦­í•˜ëŠ” ë°”ëŒì— `activate()` í•¨ìˆ˜ë¡œ í™œì„±í™”ê°€ ëœ ê²ƒ ê°™ê³ , ì‹œíŠ¸ ë³µì‚¬ëŠ” `duplicateActiveSheet()` í•¨ìˆ˜ë¥¼ í†µí•´ í•  ìˆ˜ ìˆëŠ” ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤. í•´ë‹¹ íŒŒì¼ì€ `.gs`ë¼ëŠ” í™•ì¥ìë¥¼ ê°€ì§€ê³  ìˆì—ˆê³ , ê´€ë ¨ API ë¬¸ì„œê°€ ë¶„ëª… ìˆì„ ê²ƒ ê°™ì•„ì„œ ì°¾ì•„ë´¤ë‹¤.

### Google Apps Script (.gs)

modern JavaScript platform (V8ì—”ì§„ ëŸ°íƒ€ì„) ì—ì„œ ë™ì‘í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ ì–¸ì–´ë¡œ Google Apps (Calender, Drive, Gmail, Sheets, Slides ...) ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. [ìì„¸í•œ ë‚´ìš©](https://developers.google.com/apps-script/guides/v8-runtime)

ì‚¬ìš©í•´ë³´ë‹ˆ ê¸°ë³¸ì ìœ¼ë¡œ JavaScript ë¬¸ë²•ì— ê° Google App ë³„ë¡œ ì œê³µë˜ëŠ” API í•¨ìˆ˜ë“¤ì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê²ƒìœ¼ë¡œ ëŠê»´ì§„ë‹¤.

GitHub API, OAuth, JSON, XML Parser ë“± ë‹¤ì–‘í•œ APIë“¤ê³¼ ìƒí˜¸ì‘ìš© í•  ìˆ˜ ìˆë‹¤ê³  í•œë‹¤. [ìì„¸í•œ ë‚´ìš©](https://developers.google.com/apps-script/guides/services/external)

-----

ê·¸ ê²°ê³¼ ë‹¤ìŒê³¼ ê°™ì´ ìë™í™” ë§¤í¬ë¡œë¥¼ ì™„ì„±ì‹œì¼°ë‹¤.

![210907152807.png](/assets/images/210907152807.png)

```js
/** @OnlyCurrentDoc */

function myFunction() {
  const spreadsheet = SpreadsheetApp.getActive();
  const sheetName = spreadsheet.getSheetName();
  const newSheet = spreadsheet.duplicateActiveSheet();
  
  let cnt = parseInt(/\d+/.exec(sheetName)) +1;  

  newSheet.setName(`DAY${cnt}`);
  newSheet.getRange('A1').setValue(`${cnt}ì¼ì°¨`);
  newSheet.getRange('B1').setValue(`=TODAY()`).setNumberFormat(' yyyy.mm.dd (ddd)');
  newSheet.getRange('A3:I19').clearContent().setFontColor("black");
};
```

`SpreadsheetApp.getActive()` í•¨ìˆ˜ë¥¼ í†µí•´ì„œ [Class Spreadsheet](https://developers.google.com/apps-script/reference/spreadsheet/spreadsheet) ë¥¼ ì–»ê³  ì œê³µë˜ëŠ” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ ì‹œíŠ¸ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆë‹¤.

í˜„ì¬ ì‹œíŠ¸ì˜ ì´ë¦„ì„ ê°€ì ¸ì™€ì„œ ìˆ«ìë¶€ë¶„ë§Œ ì •ê·œí‘œí˜„ì‹ìœ¼ë¡œ ì¶”ì¶œí•œë‹¤. 1ì„ ë”í•´ì„œ cnt ë³€ìˆ˜ì— ì €ì¥í•˜ê³  ìƒˆë¡œ ë§Œë“¤ ì‹œíŠ¸ì— ì´ë¦„(DAY0), '0ì¼ì°¨'ë¥¼ í‘œì‹œí•  ë•Œ ì‚¬ìš©í•œë‹¤.

`newSheet.getRange('B1').setValue(`=TODAY()`).setNumberFormat(' yyyy.mm.dd (ddd)');` ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë™ì‘í•œë‹¤.

Spreadsheet ê°ì²´ì—ì„œ ì œê³µí•˜ëŠ” `getRange()` í•¨ìˆ˜ë¥¼ í†µí•´ 'B1' ì…€ ì˜ì—­ì— í•´ë‹¹í•˜ëŠ” [Class Range](https://developers.google.com/apps-script/reference/spreadsheet/range) ë¥¼ ì–»ê³  ì œê³µë˜ëŠ” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ ì‹œíŠ¸ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆë‹¤.

B1 ì…€ì— ì—‘ì…€ì—ì„œ ë‚ ì§œë¥¼ í‘œì‹œí•˜ëŠ” ìˆ˜ì‹ `=TODAY()` ë¥¼ ì…ë ¥í•˜ë©´ `=TODAY()` ê¸€ì ê·¸ëŒ€ë¡œ í…ìŠ¤íŠ¸ê°€ ì…ë ¥ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ìˆ˜ì‹ í•¨ìˆ˜ê°€ ì—‘ì…€ì—ì„œì²˜ëŸ¼ ë™ì‘í•˜ì—¬ ê²°ê³¼ê°’ì´ ì…ë ¥ëœë‹¤.

*Range ê°ì²´ì—ì„œ getì„ ì œì™¸í•œ ì—¬ëŸ¬ í•¨ìˆ˜ë“¤ì€ ê³„ì† ìŠ¤ìŠ¤ë¡œë¥¼ ë¦¬í„´í•œë‹¤. ì¦‰, this Rnage ê°ì²´ë¥¼ ë¦¬í„´í•œë‹¤. ê·¸ë˜ì„œ ì²´ì´ë‹ì´ ê°€ëŠ¥í•´ì§„ë‹¤.*

ë‚ ì§œ í¬ë§·ì„ `2021.09.07 (í™”)` ì™€ ê°™ì´ ì§€ì •í–ˆë‹¤. ìŠ¤í”„ë ˆë“œì‹œíŠ¸(ì—‘ì…€) ë‚´ì—ì„œ `ì„œì‹ > ìˆ«ì` ë©”ë‰´ì—ì„œ ì„œì‹ì„ ì§€ì •í•´ì£¼ëŠ” ê²ƒê³¼ ê°™ì€ ë™ì‘ì´ë‹¤.

`newSheet.getRange('A3:I19').clearContent().setFontColor("black");` ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë™ì‘í•œë‹¤.

'A3:I19' ì…€ ì˜ì—­ì— í•´ë‹¹í•˜ëŠ” Range ê°ì²´ë¥¼ ì–»ê³ , `clearContent()` í•¨ìˆ˜ë¡œ ë‚´ìš©ì„ ì§€ì›Œì¤€ë‹¤. `clear()`ë¥¼ ì‚¬ìš©í•˜ë©´ ì ìš©ëœ ì˜µì…˜ê¹Œì§€ ë‹¤ ì§€ì›Œì§€ë¯€ë¡œ ì£¼ì˜í•œë‹¤. ê·¸ë¦¬ê³  `setFontColor()` í•¨ìˆ˜ë¥¼ ì´ìš©í•´ì„œ ì˜¤ë‹µì„ ìœ„í•´ ë¹¨ê°„ìƒ‰ìœ¼ë¡œ ì²˜ë¦¬í•œ ì…€ë“¤ì„ ë‹¤ì‹œ ê²€ì€ìƒ‰ìœ¼ë¡œ ëª¨ë‘ ë³€ê²½í•´ì¤€ë‹¤.

<br>

## ğŸ¤£

ë­”ê°€, í•˜ë‹¤ë³´ë‹ˆ ì—´ì‹¬íˆ(ì‹ ë‚˜ê²Œ) ë§Œë“¤ì—ˆëŠ”ë°, ë™ìƒí•œí…Œ ì‚¬ìš©í•˜ë¼ê³  í–ˆë”ë‹ˆ...

*ìš°ë¦¬ê°€ ì•ìœ¼ë¡œ ì‹œí—˜ë³´ëŠ” ë‚  ê¹Œì§€ ë§¤ ë²ˆ ì´ ì‘ì—…ì„ ìˆ˜ë™ìœ¼ë¡œ í•˜ëŠ” ì‹œê°„ì„ ë‹¤ í•©ì³ë„ ì–¸ë‹ˆê°€ ì´ê±° ë§Œë“œëŠ” ì‹œê°„ë³´ë‹¤ ì˜¤ë˜ ê±¸ë ¸ì„ê¹Œ?*

ë¼ëŠ” ì§ˆë¬¸ì„ ë°›ì•˜ë‹¤. ã…‹ã…‹ã…‹

-----

>Reference
- https://support.google.com/docs/answer/9331168?hl=ko
- https://developers.google.com/apps-script/reference/spreadsheet/spreadsheet
- https://developers.google.com/apps-script/reference/spreadsheet/range
